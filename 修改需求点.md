## 交互功能专项变更说明书：DOM 智能吸附与框选混合模式

### 1. 变更概述

* **新增能力**：支持**多选/范围选取**。在保留 DOM 智能吸附的基础上，允许用户通过鼠标左键长按拖拽，划定一个矩形区域，自动识别并选中该区域内的所有符合条件的 DOM 节点。

---

### 2. 核心交互状态机

#### 2.4 状态四：区域框选态

* **触发**：在【巡查态】下，用户在空白处或按下特定修饰键（如 `Shift`）的同时，按住**鼠标左键并移动**。
* **逻辑**：
* 以点击起点为坐标原点，实时绘制一个半透明矩形框。
* **碰撞检测**：系统计算矩形框覆盖的坐标范围，识别所有落入该范围内的 DOM 节点。
* **吸附优先级**：
* 若框选范围内包含多个原子元素，则全部标记为高亮。
* 若框选范围主要覆盖了一个容器元素，则自动转化为该容器的【容器态】。

* **结束**：松开鼠标左键，进入【锁定编辑态】，此时标注对象为“一组元素”或“选定区域”。

---

### 3. 视觉规范

#### 3.3 风格 C：群组/区域态

* **适用对象**：通过鼠标拖拽框选出的多个不连续或连续元素。
* **视觉特征**：
* **外框**：整个框选区域外围显示 1px 绿色细实线。
* **内部元素**：被选中的子元素各自叠加【原子态】的淡绿色填充，但不显示单独的标签。
* **总标签**：在矩形区域顶部显示 `Group (X items)`。

---

### 4. 详细操作流程

| 步骤 | 用户动作 | 系统反馈 (UI/UX) |
| --- | --- | --- |
| **2.1 框选开始** | 按住 Shift + 鼠标左键拖拽 | 页面出现绿色半透明拉框，光标变为 `crosshair`。 |
| **2.2 范围判定** | 拖拽覆盖三个图片卡片 | 被覆盖的图片实时闪烁淡绿色光影。 |
| **2.3 释放锁定** | 松开鼠标 | 自动计算三个卡片的共同父级或组成数组，弹出“批量标注浮层”。 |

---

### 5. 异常与边界情况

5. **框选嵌套逻辑**：
* 如果框选范围同时包含父容器及其内部的所有子元素，默认仅锁定**最外层容器**，以保持数据纯净，防止冗余标注。

6. **空选处理**：
* 若框选区域内不包含任何有效的文本、图片或交互元素（如纯空白 Div），释放鼠标后自动取消框选并回到【巡查态】。
